<svg width="900" height="520" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .lane { fill:#f8fafc; stroke:#cbd5e1; }
      .box { fill:#fff; stroke:#4a5568; stroke-width:1.5; rx:8; }
      .label { font: 14px 'Segoe UI', Roboto, sans-serif; fill:#2d3748; }
      .arrow { stroke:#2b6cb0; stroke-width:2; marker-end:url(#arrow); }
    </style>
    <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M0 0 L10 5 L0 10 z" fill="#2b6cb0" />
    </marker>
  </defs>

  <rect x="0" y="0" width="100%" height="100%" fill="#ffffff" />

  <!-- Actors -->
  <text x="60" y="40" class="label">User / Frontend</text>
  <text x="320" y="40" class="label">Backend (Ingest & RAG)</text>
  <text x="640" y="40" class="label">Services</text>

  <!-- Boxes -->
  <g>
    <rect class="box" x="30" y="60" width="160" height="60" />
    <text x="110" y="95" text-anchor="middle" class="label">Upload / Chat UI</text>

    <rect class="box" x="250" y="60" width="260" height="60" />
    <text x="380" y="95" text-anchor="middle" class="label">Document Ingestion & RAG</text>

    <rect class="box" x="540" y="60" width="260" height="60" />
    <text x="670" y="95" text-anchor="middle" class="label">Qdrant / Ollama (Embed + LLM)</text>
  </g>

  <!-- Flow arrows -->
  <path class="arrow" d="M 190 90 L 250 90" />
  <path class="arrow" d="M 510 90 L 540 90" />

  <!-- Detailed steps below -->
  <g transform="translate(40,180)">
    <rect class="box" x="0" y="0" width="220" height="40" />
    <text x="110" y="26" text-anchor="middle" class="label">1. Upload file -> saved to disk</text>

    <rect class="box" x="260" y="0" width="260" height="40" />
    <text x="390" y="26" text-anchor="middle" class="label">2. Extract text (pdf-parse / mammoth) & detect category</text>

    <rect class="box" x="540" y="0" width="260" height="40" />
    <text x="670" y="26" text-anchor="middle" class="label">3. Chunk, embed, upsert to Qdrant</text>

    <path class="arrow" d="M 220 20 L 260 20" />
    <path class="arrow" d="M 520 20 L 540 20" />
  </g>

  <g transform="translate(40,280)">
    <rect class="box" x="0" y="0" width="220" height="40" />
    <text x="110" y="26" text-anchor="middle" class="label">4. User asks question</text>

    <rect class="box" x="260" y="0" width="260" height="40" />
    <text x="390" y="26" text-anchor="middle" class="label">5. Embed question, search Qdrant</text>

    <rect class="box" x="540" y="0" width="260" height="40" />
    <text x="670" y="26" text-anchor="middle" class="label">6. Re-rank, build context, call LLM</text>

    <path class="arrow" d="M 220 20 L 260 20" />
    <path class="arrow" d="M 520 20 L 540 20" />
  </g>
</svg>